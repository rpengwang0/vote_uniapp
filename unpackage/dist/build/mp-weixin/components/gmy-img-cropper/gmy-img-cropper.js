(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/gmy-img-cropper/gmy-img-cropper"],{3506:function(t,e,r){"use strict";(function(t){function r(t,e){return o(t)||n(t,e)||i(t,e)||a()}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(t,e){if(t){if("string"===typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function n(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var r=[],a=!0,i=!1,c=void 0;try{for(var n,o=t[Symbol.iterator]();!(a=(n=o.next()).done);a=!0)if(r.push(n.value),e&&r.length===e)break}catch(u){i=!0,c=u}finally{try{a||null==o["return"]||o["return"]()}finally{if(i)throw c}}return r}}function o(t){if(Array.isArray(t))return t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var u,s,h,p,f,g,l,d,m,v,y,b=t.getSystemInfoSync(),S=b.screenWidth,w=b.windowHeight+40,T=(b.pixelRatio,1),I=b.screenWidth,L={data:function(){return{imageSrc:"",isShow:!1,isShowImg:!1,cropperInitW:S,cropperInitH:w,cropperW:S,cropperH:w-100,cropperL:0,cropperT:0,transL:0,transT:0,scaleP:0,imageW:0,imageH:0,cutL:0,cutT:0,cutB:S,cutR:"100%",qualityWidth:I,innerAspectRadio:T}},props:{quality:{type:Number|String,default:1},imgSrc:{type:String,default:""},fileType:{type:String,default:"png",validator:function(t){return"png"===t||"jpg"===t}},cropperType:{type:String,default:"free",validator:function(t){return"free"===t||"fixed"===t||"ratio"===t}},ratio:{type:Number,default:1}},created:function(){this.imgSrc&&this.imageSrc.length>1&&(this.imageSrc=this.imgSrc,this.loadImage(),this.isShow=!0,this.isShowImg=!0)},methods:{setData:function(t){var e=this;Object.keys(t).forEach((function(r){e.$set(e.$data,r,t[r])}))},setImageSrc:function(t){this.imageSrc=t,this.loadImage(),this.isShow=!0,this.isShowImg=!0},chooseImage:function(){var e=this;t.chooseImage({success:function(t){e.setData({imageSrc:t.tempFilePaths[0]}),e.loadImage(),e.isShow=!0}})},loadImage:function(){var e=this;t.showLoading({title:"图片加载中..."}),t.getImageInfo({src:e.imageSrc,success:function(a){var i=a.height,c=a.width;m=c/i,m<1&&(w-120)*m<S-10?(v=(w-120)*m,y=w-120):(v=S-10,y=v/m);var n=e.initCutArea(m,y,v),o=r(n,4),u=o[0],s=o[1],h=o[2],p=o[3];e.setData({cropperW:v,cropperH:y,cropperL:Math.ceil((S-v)/2),cropperT:Math.ceil((w-y-90)/2),cutL:h,cutT:u,cutR:p,cutB:s,imageW:v,imageH:y,scaleP:v/S,qualityWidth:I,innerAspectRadio:m}),e.setData({isShowImg:!0}),t.hideLoading()}})},initCutArea:function(t,e,r){var a=this,i=0,c=0,n=0,o=0;if("fixed"==a.cropperType&&(t<1?(i=(e-r)/2,c=(e-r)/2):(n=(r-e)/2,o=(r-e)/2)),"ratio"==a.cropperType){var u=+a.ratio;t<1?r/u>e?(i=c=0,n=o=(r-e*u)/2):(o=n=0,i=c=(e-r/u)/2):e*u>r?(n=o=0,c=i=(e-r/u)/2):(i=c=0,n=o=(r-e*u)/2)}return[i,c,n,o]},contentStartMove:function(t){u=t.touches[0].pageX,s=t.touches[0].pageY},contentMoveing:function(t){var e=(u-t.touches[0].pageX)*T,r=(s-t.touches[0].pageY)*T;e>0?this.cutL-e<0&&(e=this.cutL):this.cutR+e<0&&(e=-this.cutR),r>0?this.cutT-r<0&&(r=this.cutT):this.cutB+r<0&&(r=-this.cutB),this.setData({cutL:this.cutL-e,cutT:this.cutT-r,cutR:this.cutR+e,cutB:this.cutB+r}),u=t.touches[0].pageX,s=t.touches[0].pageY},contentTouchEnd:function(){},previewImg:function(){var e=this;try{var r=this;t.showLoading({title:"图片生成中..."});var a=t.createCanvasContext("myCanvas",r);a.drawImage(r.imageSrc,0,0,v,y),a.draw(!0,(function(){var a=(r.cropperW-r.cutL-r.cutR)/r.cropperW*v,i=(r.cropperH-r.cutT-r.cutB)/r.cropperH*y,c=r.cutL/r.cropperW*v,n=r.cutT/r.cropperH*y;t.canvasToTempFilePath({x:c,y:n,width:a,height:i,quality:+e.quality,fileType:e.fileType,canvasId:"myCanvas",success:function(e){t.hideLoading(),t.previewImage({current:"",urls:[e.tempFilePath]})},fail:function(e){t.hideLoading(),t.showToast({title:"图片截取失败！",icon:"none"})}},r)}))}catch(i){}},finish:function(){var e=this,r=this;t.showLoading({title:"图片生成中..."});var a=t.createCanvasContext("myCanvas",r);a.drawImage(r.imageSrc,0,0,v,y),a.draw(!0,(function(){var a=(r.cropperW-r.cutL-r.cutR)/r.cropperW*v,i=(r.cropperH-r.cutT-r.cutB)/r.cropperH*y,c=r.cutL/r.cropperW*v,n=r.cutT/r.cropperH*y;t.canvasToTempFilePath({x:c,y:n,width:a,height:i,quality:+e.quality,fileType:e.fileType,canvasId:"myCanvas",success:function(e){t.hideLoading(),r.$emit("getImg",e.tempFilePath),r.isShow=!1},fail:function(e){t.hideLoading(),t.showToast({title:"图片截取失败！",icon:"none"})}},r)}))},dragStart:function(t){h=t.touches[0].pageX,p=t.touches[0].pageY,f=this.cutL,l=this.cutR,d=this.cutB,g=this.cutT},dragMove:function(t){this[this.cropperType+"Drag"](t)},fixedDrag:function(t){var e=this,r=t.target.dataset.drag;switch(r){case"rightBottom":var a=(h-t.touches[0].pageX)*T;l+a<0&&(a=-l);var i=d+a,c=l+a;if(0==e.cutB&&i<0)return;if(0==e.cutR&&c<0)return;(e.cutB>0||0==d)&&this.setData({cutB:i<0?0:i,cutR:c});break;default:break}},ratioDrag:function(t){var e=this,r=t.target.dataset.drag;switch(r){case"rightBottom":var a=(h-t.touches[0].pageX)*T;l+a<0&&(a=-l);var i=d+a/e.ratio,c=l+a;if(0==e.cutB&&i<0)return;if(0==e.cutR&&c<0)return;(e.cutB>0||0==d)&&this.setData({cutB:i<0?0:i,cutR:c});break;default:break}},freeDrag:function(t){var e=t.target.dataset.drag;switch(e){case"right":var r=(h-t.touches[0].pageX)*T;l+r<0&&(r=-l),this.setData({cutR:l+r});break;case"left":r=(h-t.touches[0].pageX)*T;f-r<0&&(r=f),f-r>this.cropperW-this.cutR&&(r=f-(this.cropperW-this.cutR)),this.setData({cutL:f-r});break;case"top":r=(p-t.touches[0].pageY)*T;g-r<0&&(r=g),g-r>this.cropperH-this.cutB&&(r=g-(this.cropperH-this.cutB)),this.setData({cutT:g-r});break;case"bottom":r=(p-t.touches[0].pageY)*T;d+r<0&&(r=-d),this.setData({cutB:d+r});break;case"rightBottom":var a=(h-t.touches[0].pageX)*T,i=(p-t.touches[0].pageY)*T;d+i<0&&(i=-d),l+a<0&&(a=-l);var c=d+i,n=l+a;this.setData({cutB:c,cutR:n});break;default:break}}}};e.default=L}).call(this,r("543d")["default"])},"3aa8":function(t,e,r){},4149:function(t,e,r){"use strict";var a;r.d(e,"b",(function(){return i})),r.d(e,"c",(function(){return c})),r.d(e,"a",(function(){return a}));var i=function(){var t=this,e=t.$createElement;t._self._c},c=[]},9033:function(t,e,r){"use strict";r.r(e);var a=r("3506"),i=r.n(a);for(var c in a)"default"!==c&&function(t){r.d(e,t,(function(){return a[t]}))}(c);e["default"]=i.a},bee0:function(t,e,r){"use strict";r.r(e);var a=r("4149"),i=r("9033");for(var c in i)"default"!==c&&function(t){r.d(e,t,(function(){return i[t]}))}(c);r("e75d");var n,o=r("f0c5"),u=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],n);e["default"]=u.exports},e75d:function(t,e,r){"use strict";var a=r("3aa8"),i=r.n(a);i.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/gmy-img-cropper/gmy-img-cropper-create-component',
    {
        'components/gmy-img-cropper/gmy-img-cropper-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("bee0"))
        })
    },
    [['components/gmy-img-cropper/gmy-img-cropper-create-component']]
]);
