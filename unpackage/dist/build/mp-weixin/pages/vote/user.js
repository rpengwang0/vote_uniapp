(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/vote/user"],{"1e6e":function(t,i,e){"use strict";var a=e("1fdc"),n=e.n(a);n.a},"1fdc":function(t,i,e){},"50a3":function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a={data:function(){return{player_id:0,activity_id:0,activity_title:"",data:{},swiperHeight:350,giftList:[],giftData:{num:10,currentIndex:0},time:10,longPress:!0,count:12,selectedGiftId:0,biubiushow:"hide",index:0,num:0}},onLoad:function(i){this.player_id=i.id||0,this.getData();var e=this,a=t.getStorageSync("activity");e.activity_id=a.activity_id,e.activity_title=a.activity_title,e.$u.api.sys.getGiftList({activity_id:e.activity_id}).then((function(t){if(1==t.code){var i={activity_id:1,gift_img:"https://tp.guomei.work/giftimg/dianzan.jpg",gift_name:"点赞",gift_price:0,gift_ticket_num:1,id:1};t.data.unshift(i),e.giftList=t.data}}))},methods:{zan:function(t){this.count+=t},getData:function(){var t={id:1,title:"这是测试投票",user_name:"快投我",vote_count:99,leaderboard:1,user_url:[{url:"/static/image/user1.jpeg"},{url:"/static/image/user2.png"},{url:"/static/image/user3.png"},{url:"/static/image/user4.jpeg"}],user_desc:"我是大美女 "};this.data=t;var i=this;i.$u.api.sys.getPlayerInfo({activity_id:i.activity_id,player_id:i.player_id}).then((function(t){1==t.code&&(i.data=t.data)}))},swiperChange:function(t){var i=t.detail.current;this.setSwiperHeight(i)},setSwiperHeight:function(i){var e=this,a=t.createSelectorQuery();a.select(".img"+i).boundingClientRect(),a.exec((function(t){e.swiperHeight=t[0].height}))},toPay:function(i){var a=this;console.log("topay");var n=this;if(t.showLoading({title:"加载中"}),t.getStorageSync("uid"))if(0==n.giftData.currentIndex){var u=n.activity_id+"|"+t.getStorageSync("uid")+"|"+n.data.player_id+"|"+n.giftData.num,c=e("71b3"),r=new c.JSEncrypt;r.setPrivateKey("MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqxUGcj8TZ+827OdLxGc56MwTALFi3XR4x0eY9Qx/gSzjqSmvLmWuwtT7YaA3RQ6xihSfqAVzGXnc+nk7YI9tcfBG6PSr5qmGpqcNCtwx28t60qVa6L/uuhe/jtcSH+iqmq9t4vx2UXTxvoFnyS+Sx11QOe7KgaCRzWhM98/Iase0GZaZHCNDUGUTmJP2nOuM+8rvTkR9fV5mrj8/K+1qLPpYftbkLZ+g3fsoxiUN0fV/jDhXulH3wgZ40T6VPw3HR1i99cLyGtrim8SGxcnlplHTGz9+TxyG5FdNtDuRTQ0RaeTUv0KdGeMNxLwMo3wrW6DzcuuCcnP/0Yh05oQrMQIDAQAB");var o=r.encrypt(u);n.$u.api.sys.clickPlayerTicket({activity_id:n.activity_id,player_id:n.player_id,uid:t.getStorageSync("uid"),num:n.data.num,esign:o},{"content-type":"application/x-www-form-urlencoded",actoken:t.getStorageSync("uid")}).then((function(t){if(console.log(t),1!=t.code)return a.globalUtil.utilAlert(t.msg),!1;n.biubiushow="show",n.zan(t.data.addnum),setTimeout((function(){n.biubiushow="hide"}),3e3),n.getData()}))}else n.$u.api.sys.createOrder({activity_id:n.activity_id,player_id:n.player_id,gift_id:n.giftData.gift_id,num:n.giftData.num,uid:t.getStorageSync("uid")}).then((function(t){if(1!=t.code)return a.globalUtil.utilAlert(t.msg),!1;n.wechatpay(t.data.order_id)}));else t.hideLoading(),t.navigateTo({url:"/pages/index/login"})},wechatpay:function(i){var e=this,a=this;a.$u.api.sys.createMiniWeChatPay2({order_id:i}).then((function(i){if(1!=i.code)return e.globalUtil.utilAlert(i.msg),!1;t.requestPayment({provider:"wxpay",appId:i.data.appId,nonceStr:i.data.nonceStr,package:i.data.package,timeStamp:i.data.timeStamp,signType:"MD5",paySign:i.data.paySign,success:function(t){a.biubiushow="show",a.zan(100),setTimeout((function(){a.biubiushow="hide"}),3e3),a.getData(),console.log("success:"+JSON.stringify(t))},fail:function(t){console.log("fail:"+JSON.stringify(t))}})}))},closeGif:function(){that.setData({gifShow:!1})},giftService:function(){t.showModal({title:"提示",content:" 1、赠送礼物是个人自愿行为。\r\n    2、为了防止恶意刷票，每个选手单日最高可获得1000票免费票。\r\n             3、承办方东方华服有最终解释权。\r\n      4、非法手段投票系统会做拉黑处理，并取消参赛资格！",showCancel:!1})},addCount:function(t){var i=this.giftData.num;if(0==this.giftData.currentIndex&&i>=10)return!1;i<1e3&&this.giftData.num++,this.giftData.priceAll=Number(this.giftData.num)*this.giftData.price},delCount:function(t){var i=this.giftData.num;i>1&&this.giftData.num--,this.giftData.priceAll=Number(this.giftData.num)*this.giftData.price},giftTab:function(t){console.log(t);var i=this;i.giftData=0==t?{num:10,currentIndex:t,price:i.giftList[t].gift_price,priceAll:i.giftList[t].gift_price,gift_id:i.giftList[t].id}:{num:1,currentIndex:t,price:i.giftList[t].gift_price,priceAll:i.giftList[t].gift_price,gift_id:i.giftList[t].id,gift_blind:i.giftList[t].is_acciden},console.log(i.giftData)}}};i.default=a}).call(this,e("543d")["default"])},"5ae2":function(t,i,e){"use strict";e.d(i,"b",(function(){return n})),e.d(i,"c",(function(){return u})),e.d(i,"a",(function(){return a}));var a={uGap:function(){return e.e("node-modules/uview-ui/components/u-gap/u-gap").then(e.bind(null,"9f7a"))},uLazyLoad:function(){return e.e("node-modules/uview-ui/components/u-lazy-load/u-lazy-load").then(e.bind(null,"a900"))},peterDianzan:function(){return Promise.all([e.e("common/vendor"),e.e("components/peter-dianzan/peter-dianzan")]).then(e.bind(null,"cdd3"))},uIcon:function(){return e.e("node-modules/uview-ui/components/u-icon/u-icon").then(e.bind(null,"6a9b"))}},n=function(){var t=this,i=t.$createElement;t._self._c},u=[]},"5d58":function(t,i,e){"use strict";e.r(i);var a=e("50a3"),n=e.n(a);for(var u in a)"default"!==u&&function(t){e.d(i,t,(function(){return a[t]}))}(u);i["default"]=n.a},d216:function(t,i,e){"use strict";e.r(i);var a=e("5ae2"),n=e("5d58");for(var u in n)"default"!==u&&function(t){e.d(i,t,(function(){return n[t]}))}(u);e("1e6e");var c,r=e("f0c5"),o=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],c);i["default"]=o.exports},de80:function(t,i,e){"use strict";(function(t){e("98bb");a(e("66fd"));var i=a(e("d216"));function a(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=e,t(i.default)}).call(this,e("543d")["createPage"])}},[["de80","common/runtime","common/vendor"]]]);