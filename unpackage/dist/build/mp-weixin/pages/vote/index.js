(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/vote/index"],{"295a":function(e,t,i){"use strict";i.r(t);var n=i("daf9"),o=i.n(n);for(var r in n)"default"!==r&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t["default"]=o.a},"855b":function(e,t,i){"use strict";var n=i("ed60"),o=i.n(n);o.a},daf9:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{current:0,numList:[{name:"活动内容"},{name:"活动选项"},{name:"高级选项"},{name:"活动奖励"}],customStyle:{lineHeight:"50rpx"},form:{bg_url:"",title:"",desc:"",desc_img:[],is_open:!1,enroll_start_time:"",enroll_start_timestamp:"",enroll_end_time:"",enroll_end_timestamp:"",phone_required:!1,weixin_required:!1,is_sponsor:!1,sponsor_name:"",sponsor_mobile:"",vote_start_time:"",vote_start_timestamp:"",vote_end_time:"",vote_end_timestamp:"",share_url:"",day_vote_number:1,is_repeat_vote:!1,is_ip_region_restrict:!1,region:"全部,全部,全部",region_id:"0,0,0",ip_number:1,is_show_index:!1,prize:"",prize_img:[]},showTimePicker:!1,thisTimeType:"",thisDefaultTime:"",startYear:2022,timeParams:{year:!0,month:!0,day:!0,hour:!0,minute:!0,second:!1,timestamp:!0},showNumberSelect:!1,thisNumberType:"",numberList:[{value:"1",label:"1"},{value:"2",label:"2"},{value:"3",label:"3"},{value:"4",label:"4"},{value:"5",label:"5"},{value:"6",label:"6"},{value:"7",label:"7"},{value:"8",label:"8"},{value:"9",label:"9"},{value:"10",label:"10"}],showRegionSelect:!1,regionList:[{value:1,label:"中国",children:[{value:2,label:"广东",children:[{value:3,label:"深圳"},{value:4,label:"广州"}]},{value:5,label:"广西",children:[{value:6,label:"南宁"},{value:7,label:"桂林"}]}]},{value:8,label:"美国",children:[{value:9,label:"纽约",children:[{value:10,label:"皇后街区"}]}]}]}},onShow:function(){this.setDefaultTime()},onLoad:function(){var t=this;e.$on("crop_img_success",(function(e){console.log("收到crop通讯",e.path),t.form.bg_url=e.path}))},onUnload:function(){e.$off("crop_img_success")},methods:{cropBg:function(){e.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){var i=t.tempFilePaths[0];e.navigateTo({url:"/pages/crop/crop?tempFilePath="+i})}})},chooseImg:function(t){var i=this;e.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(n){var o=n.tempFilePaths[0];e.compressImage({src:o,quality:80,success:function(e){if("desc_img"==t){if(i.form.desc_img.length>=10)return i.globalUtil.utilAlert("最少上传10张图片"),!1;i.form.desc_img.push(e.tempFilePath)}else if("share_url"==t)i.form.share_url=e.tempFilePath;else if("prize_img"==t){if(i.form.prize_img.length>=10)return i.globalUtil.utilAlert("最少上传10张图片"),!1;i.form.prize_img.push(e.tempFilePath)}}})}})},deleteImg:function(e,t){var i=this;if("desc_img"==e){for(var n=i.form.desc_img,o=0;o<n.length;o++)if(n[o]==t){n.splice(o,1);break}i.form.desc_img=n}if("prize_img"==e){var r=i.form.prize_img;for(o=0;o<r.length;o++)if(r[o]==t){r.splice(o,1);break}i.form.prize_img=r}},checkParam:function(e){if(0==e){if(""==this.form.bg_url)return this.globalUtil.utilAlert("请上传投票封面图片"),!1;if(""==this.form.title)return this.globalUtil.utilAlert("请输入投票主题"),!1;if(""==this.form.desc)return this.globalUtil.utilAlert("请输入投票介绍"),!1}else if(1==e){if(1==this.form.is_open){if(this.form.enroll_start_timestamp>=this.form.enroll_end_timestamp)return this.globalUtil.utilAlert("报名结束时间要大于开始时间"),!1;if(this.form.enroll_end_timestamp>=this.form.vote_end_timestamp)return this.globalUtil.utilAlert("报名结束时间不得大于投票结束时间"),!1}if(1==this.form.is_sponsor){if(""==this.form.sponsor_name||" "==this.form.sponsor_name)return this.globalUtil.utilAlert("请输入主办方名称"),!1;var t=/^[1][3,4,5,6,7,8,9][0-9]{9}$/;if(!t.test(this.form.sponsor_mobile))return this.globalUtil.utilAlert("请输入正确电话"),!1}}return!0},toNext:function(){var e=this.current;if(3==e)return this.globalUtil.utilAlert("这就是最后一步"),!1;var t=this.checkParam(e);if(!1===t)return!1;e++,this.current=e>=3?3:e},toLast:function(){var e=this.current;if(0==e)return this.globalUtil.utilAlert("这就是第一步"),!1;e--,this.current=e<=0?0:e},setDefaultTime:function(){var e=parseInt((new Date).getTime()/1e3);e+=1800;var t=this.$u.timeFormat(e,"yyyy-mm-dd hh:MM");""==this.form.enroll_start_time&&(this.form.enroll_start_time=t,this.form.enroll_start_timestamp=e);var i=e+432e3,n=this.$u.timeFormat(i,"yyyy-mm-dd hh:MM");""==this.form.enroll_end_time&&(this.form.enroll_end_time=n,this.form.enroll_end_timestamp=i),""==this.form.vote_start_time&&(this.form.vote_start_time=n,this.form.vote_start_timestamp=i);var o=e+1728e3,r=this.$u.timeFormat(o,"yyyy-mm-dd hh:MM");""==this.form.vote_end_time&&(this.form.vote_end_time=r,this.form.vote_end_timestamp=o)},isOpenChange:function(e){1==e&&this.setDefaultTime()},openTimePicker:function(e){console.log("type",e),this.thisTimeType=e,this.thisDefaultTime=this.form[e],console.log(this.thisDefaultTime),this.showTimePicker=!0},confirmTimePicke:function(e){console.log("confirmTimePicke",e);var t=e.year+"-"+e.month+"-"+e.day+" "+e.hour+":"+e.minute,i=e.timestamp;"enroll_start_time"==this.thisTimeType&&(this.form.enroll_start_time=t,this.form.enroll_start_timestamp=i),"enroll_end_time"==this.thisTimeType&&(this.form.enroll_end_time=t,this.form.enroll_end_timestamp=i),"vote_start_time"==this.thisTimeType&&(this.form.vote_start_time=t,this.form.vote_start_timestamp=i),"vote_end_time"==this.thisTimeType&&(this.form.vote_end_time=t,this.form.vote_end_timestamp=i)},openNumberList:function(e){console.log("type",e),this.thisNumberType=e,this.showNumberSelect=!0},confirmNumberSelect:function(e){this.form[this.thisNumberType]=e[0].value},openRegionPicker:function(){this.showRegionSelect=!0},confirmRegionSelect:function(e){console.log("confirmRegionSelect",e),this.form.region=e[0].label+","+e[1].label+","+e[2].label,this.form.region_id=e[0].value+","+e[1].value+","+e[2].value},submit:function(){},getOpacity:function(){return 0==this.current?.3:""},previewImg:function(t){e.previewImage({urls:[t],longPressActions:{itemList:["发送给朋友","保存图片","收藏"]}})}}};t.default=i}).call(this,i("543d")["default"])},ed60:function(e,t,i){},f871:function(e,t,i){"use strict";(function(e){i("98bb");n(i("66fd"));var t=n(i("fae7"));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=i,e(t.default)}).call(this,i("543d")["createPage"])},f910:function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return n}));var n={uSteps:function(){return i.e("node-modules/uview-ui/components/u-steps/u-steps").then(i.bind(null,"322c"))},uImage:function(){return i.e("node-modules/uview-ui/components/u-image/u-image").then(i.bind(null,"54ca"))},uIcon:function(){return i.e("node-modules/uview-ui/components/u-icon/u-icon").then(i.bind(null,"6a9b"))},uInput:function(){return Promise.all([i.e("common/vendor"),i.e("node-modules/uview-ui/components/u-input/u-input")]).then(i.bind(null,"1bcd"))},uGap:function(){return i.e("node-modules/uview-ui/components/u-gap/u-gap").then(i.bind(null,"9f7a"))},uSwitch:function(){return i.e("node-modules/uview-ui/components/u-switch/u-switch").then(i.bind(null,"4c67"))},uPicker:function(){return Promise.all([i.e("common/vendor"),i.e("node-modules/uview-ui/components/u-picker/u-picker")]).then(i.bind(null,"198a"))},uSelect:function(){return i.e("node-modules/uview-ui/components/u-select/u-select").then(i.bind(null,"f74a"))}},o=function(){var e=this,t=e.$createElement,i=(e._self._c,e.getOpacity());e.$mp.data=Object.assign({},{$root:{m0:i}})},r=[]},fae7:function(e,t,i){"use strict";i.r(t);var n=i("f910"),o=i("295a");for(var r in o)"default"!==r&&function(e){i.d(t,e,(function(){return o[e]}))}(r);i("855b");var l,s=i("f0c5"),u=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,"c0126c5a",null,!1,n["a"],l);t["default"]=u.exports}},[["f871","common/runtime","common/vendor"]]]);